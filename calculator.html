<!DOCTYPE html>
<html lang="en" class="h-full"> <!-- h-full para que o html ocupe toda a altura do iframe -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Tailwind Calculator for Notion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'BlinkMacSystemFont', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', '"Noto Sans"', 'sans-serif', '"Apple Color Emoji"', '"Segoe UI Emoji"', '"Segoe UI Symbol"', '"Noto Color Emoji"'],
                        mono: ['IBM Plex Mono', 'ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', '"Liberation Mono"', '"Courier New"', 'monospace'],
                    },
                    colors: {
                        slate: { // Paleta 'slate' similar ao Notion
                            50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8',
                            500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a', 950: '#020617',
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        /* Estilo para o símbolo de raiz quadrada (overline) */
        .button > .over {
            text-decoration: overline;
            display: inline-block;
            position: relative;
            top: 0.1vmin; /* Ajustado para vmin */
            left: -0.2vmin; /* Ajustado para vmin */
        }
        /* Forçar o html e body a terem 100% da altura do container (iframe) */
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Evita barras de rolagem desnecessárias no iframe */
        }
    </style>
    <script>
        (function() {
            function applyTheme() {
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }
            applyTheme();
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyTheme);
        })();
    </script>
</head>
<body class="bg-slate-50 dark:bg-slate-900 flex items-center justify-center font-sans transition-colors duration-300">

    <div class="calculator bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-slate-200 dark:border-slate-700 
                w-full h-full font-mono flex flex-col p-[1.5vmin]">
        
        <input type="text" id="screen" 
               class="w-full p-[1.5vmin] text-[5vmin] text-right bg-slate-100 dark:bg-slate-700 
                      text-slate-800 dark:text-slate-100 rounded-md focus:outline-none 
                      focus:ring-2 focus:ring-slate-400 dark:focus:ring-slate-500 
                      transition-colors duration-300 mb-[1.5vmin] min-h-[8vmin] flex-shrink-0" readonly> 
        
        <div class="button-grid flex-grow grid grid-cols-4 gap-[1vmin]">
    
            <button class="button btn-op">(</button>
            <button class="button btn-op">)</button>
            <button class="button btn-op">%</button>
            <button class="button btn-ac">AC</button>

            <button class="button btn-op">x^</button>
            <button class="button btn-num">7</button>
            <button class="button btn-num">8</button>
            <button class="button btn-num">9</button>

            <button class="button btn-op">&radic;<span class="over"></span></button>
            <button class="button btn-num">4</button>
            <button class="button btn-num">5</button>
            <button class="button btn-num">6</button>

            <button class="button btn-op">*</button>
            <button class="button btn-num">1</button>
            <button class="button btn-num">2</button>
            <button class="button btn-num">3</button>
            
            <button class="button btn-op">/</button>
            <button class="button btn-num">0</button>
            <button class="button btn-num">.</button>
            <button class="button btn-op">-</button>
            
            <button class="button btn-op col-span-2">+</button>
            <button class="button btn-equals col-span-2">=</button>
        </div>
    </div>

    <style type="text/tailwindcss">
        @layer components {
            .button {
                @apply rounded-md font-medium transition-all duration-150 ease-in-out
                       focus:outline-none focus:ring-1 focus:ring-offset-1 
                       dark:focus:ring-offset-slate-800 focus:ring-slate-500 dark:focus:ring-slate-400
                       active:scale-95
                       p-[1.5vmin] text-[2.8vmin] /* Padding e tamanho da fonte com vmin */
                       flex items-center justify-center; /* Para centralizar conteúdo do botão */
            }
            .btn-num {
                @apply bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600
                       text-slate-800 dark:text-slate-200 border border-slate-200 dark:border-slate-600;
            }
            .btn-op {
                @apply bg-slate-200 dark:bg-slate-600 hover:bg-slate-300 dark:hover:bg-slate-500
                       text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-500;
            }
            .btn-ac {
                @apply bg-slate-300 dark:bg-slate-500 hover:bg-slate-400 dark:hover:bg-slate-400
                       text-slate-700 dark:text-slate-100 font-semibold border border-slate-400 dark:border-slate-400;
            }
            .btn-equals {
                @apply bg-slate-700 dark:bg-slate-400 hover:bg-slate-600 dark:hover:bg-slate-300
                       text-white dark:text-slate-900 font-semibold border border-slate-700 dark:border-slate-400;
            }
        }
    </style>

    <!-- O JavaScript da lógica da calculadora permanece o mesmo -->
    <script>
        var display = document.getElementById("screen");
        var buttons = document.querySelectorAll(".calculator .button"); 
        
        Array.prototype.forEach.call(buttons, function(button) {
        button.addEventListener("click", function() {
            const buttonText = button.textContent.trim();
            if (buttonText === "√") {
                if(display.value && !isNaN(parseFloat(display.value))) {
                    display.value = Math.sqrt(parseFloat(display.value));
                } else {
                    display.value = "Error";
                }
                return;
            }

            if (buttonText != "=" && 
            buttonText != "AC" && 
            buttonText != "*" && 
            buttonText != "/" && 
            buttonText != "+" && 
            buttonText != "%" && 
            buttonText != "-" && 
            buttonText != "sin" && 
            buttonText != "cos" && 
            buttonText != "tan" && 
            buttonText != "log" && 
            buttonText != "ln" && 
            buttonText != "x^" && 
            buttonText != "x!" && 
            buttonText != "pi" && 
            buttonText != "Rad" &&
            buttonText != "Deg") {
            display.value += buttonText;
            } else if (buttonText === "=") {
            equals();
            } else if (buttonText === "AC") {
            clear();
            } else if (buttonText === "*") {
            multiply();
            } else if (buttonText === "/") {
            divide();
            } else if (buttonText === "+") {
            plus();
            } else if (buttonText === "-") {
            Minus();
            } else if (buttonText === "%") {
            percent();
            } else if (buttonText === "pi") {
            pi();
            } else if (buttonText === "sin") {
            sin();
            } else if (buttonText === "cos") {
            cos();
            } else if (buttonText === "tan") {
            tan();
            } else if (buttonText === "log") {
            log();
            } else if (buttonText === "ln") {
            ln();
            } else if (buttonText === "x^") {
            exponent();
            } else if (buttonText === "x!") {
            factorial();
            } else if (buttonText === "Rad") {
            radians();
            } else if (buttonText === "Deg") {
            degrees();
            }
        });
        });

        function syntaxError() {
            try {
                new Function('return ' + display.value)();
            } catch (e) {
                if (e instanceof SyntaxError || e instanceof ReferenceError || e instanceof TypeError) {
                display.value = "Syntax Error";
                }
            }
        }

        function equals() {
            if ((display.value).indexOf("^") > -1) {
                var base = (display.value).slice(0, (display.value).indexOf("^"));
                var exponent_val = (display.value).slice((display.value).indexOf("^") + 1); 
                try {
                    let numBase = parseFloat(base);
                    let numExponent = parseFloat(exponent_val);
                    if (isNaN(numBase) || isNaN(numExponent)) throw "Error";
                    display.value = Math.pow(numBase, numExponent);
                } catch (e) {
                    display.value = "Error";
                }
            } else {
                try {
                    const result = new Function('return ' + display.value)();
                    if (typeof result === 'number' && !isNaN(result)) {
                        display.value = result;
                    } else {
                        display.value = "Error";
                    }
                } catch (e) {
                    display.value = "Error";
                }
            }
        }

        function clear() {
            display.value = "";
        }

        function multiply() { display.value += "*"; }
        function divide() { display.value +=  "/"; }
        function plus() { display.value +=  "+"; }
        function Minus() { display.value +=  "-"; }

        function factorial() {
            var number = 1;
            var val = parseFloat(display.value);
            if (isNaN(val) || val < 0 || !Number.isInteger(val)) { 
                display.value = "Error"; 
                return;
            }
            if (val === 0) {
                display.value = "1";
            } else {
                for (var i = val; i > 0; i--) { number *=  i; }
                display.value = number;
            }
        }

        function pi() {
            if (display.value === "" || isNaN(parseFloat(display.value.slice(-1)))) {
                display.value += Math.PI.toFixed(8);
            } else {
                 try { display.value = (parseFloat(display.value) * Math.PI).toFixed(8); } catch (e) { display.value = "Error"; }
            }
        }
        
        function percent() {
            try { display.value = parseFloat(display.value) / 100; } catch(e) { display.value = "Error"; }
        }

        function sin() { try { display.value = Math.sin(parseFloat(display.value)); } catch(e) { display.value = "Error";} }
        function cos() { try { display.value = Math.cos(parseFloat(display.value)); } catch(e) { display.value = "Error";} }
        function tan() { try { display.value = Math.tan(parseFloat(display.value)); } catch(e) { display.value = "Error";} }
        function log() { try { display.value = Math.log10(parseFloat(display.value)); } catch(e) { display.value = "Error";} }
        function ln() { try { display.value = Math.log(parseFloat(display.value)); } catch(e) { display.value = "Error";} }
        function exponent() { display.value += "^"; }
        function radians() { try { display.value = parseFloat(display.value) * (Math.PI / 180); } catch(e) { display.value = "Error";} }
        function degrees() { try { display.value = parseFloat(display.value) * (180 / Math.PI); } catch(e) { display.value = "Error";} }
    </script>
</body>
</html>
